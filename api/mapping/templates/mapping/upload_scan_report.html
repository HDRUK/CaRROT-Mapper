{% extends "base.html" %}

{% block body %}

<nav aria-label="breadcrumb">
    <ol class="breadcrumb">
        <li class="breadcrumb-item"><a href="{% url 'home' %}">Home</a></li>
        <li class="breadcrumb-item"><a href="{% url 'scan-report-list' %}">Scan
            reports</a></li>
    </ol>
</nav>
<h2>New Scan Report</h2>

<form method="post" name="simpleForm" id="simpleForm" action="#" enctype="multipart/form-data">{% csrf_token %}
    <div class="mb-3">
        {{ form.data_partner.errors }}
        <label class="form-label" id='data_partner'>{{ form.data_partner.label }}</label>
        {{ form.data_partner }}
    </div>

    <div class="mb-3">
        {{ form.dataset.errors }}
        <label class="form-label">{{ form.dataset.label}}</label>
        {{ form.dataset }}
    </div>

    <div class="mb-3">

        <label class="form-label">{{ form.scan_report_file.label }}</label>
        {{ form.scan_report_file }}
        {%if form.scan_report_file.errors%}
        <div class="alert alert-danger" role="alert">{{ form.scan_report_file.errors }}</div>
        {%endif%}

    </div>

    <div class="mb-3">

        <label class="form-label">{{ form.data_dictionary_file.label }}</label>
        {{ form.data_dictionary_file }}
        {%if form.data_dictionary_file.errors%}
        <div class="alert alert-danger" role="alert">{{ form.data_dictionary_file.errors }}</div>
        {%endif%}

    </div>
    <div class="row mx-auto">
        <div class="spinner-border mx-auto d-none" name="spinner" id="spinner" role="status">
          <span class="sr-only">Loading...</span>
        </div>
    </div>
    <button type="submit" class="btn btn-primary" id="btn">Submit</button>

</form>
<script>

$("#simpleForm").on('submit',function(ev) {      
        $.ajax({
        type: "POST",
        data: {
        'csrfmiddlewaretoken': '{{ csrf_token }}',
        },
        beforeSend: function (data) {
        $('#spinner').addClass('d-none');
        },
        success: function (data) {
            $('#spinner').removeClass('d-none');
        },
        error: function(data,XMLHttpRequest, textStatus, errorThrown){
            $('#spinner').addClass('d-none');
        }
	});
  });
</script>
{% endblock %}
